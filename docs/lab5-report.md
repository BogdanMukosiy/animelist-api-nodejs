# Лабораторна робота №5 — Тестування програмного забезпечення

## 1. Unit-тестування

Було реалізовано unit-тести для модуля валідації Reviews (`src/modules/reviews/reviews.validators.ts`).
Покрито функції:

- `normalizeRating()` — перевірка, що rating є числом та знаходиться в діапазоні 1..10
- `normalizeText()` — перевірка, що текст не порожній, обрізається пробіли та має обмеження довжини

Unit-тести не потребують підключення до БД і виконуються швидко.

---

## 2. Інтеграційні тести

Інтеграційні тести налаштовано через Jest + Supertest.
Тести перевіряють роботу API разом з реальною базою даних PostgreSQL через Prisma.

Покрито основні модулі:

- Anime CRUD (`/anime`)
- List (`/me/list`)
- Reviews (`/anime/:id/reviews`)
- Health endpoint (`/health`)

Перед виконанням тестів БД очищується (cleanup), щоб забезпечити стабільність результатів.

---

## 3. E2E тестування

Додано E2E тест, який запускає реальний HTTP сервер через `app.listen(0)` і виконує запит до `/health`.
Це перевіряє повний шлях: HTTP → Express → middleware → router → відповідь.

---

## 4. Мутаційне тестування (Mutation Testing)

Для перевірки якості тестів використано StrykerJS.

### Результати мутаційного тестування:

- Mutation score: **80.90%**
- Killed mutants: **127**
- Survived mutants: **34**
- Timeout mutants: **17**
- Errors: **29**

HTML-звіт сформовано автоматично: `reports/mutation/mutation.html`

---

## 5. Висновок та що можна покращити

Покриття тестами є достатньо ефективним, оскільки більшість мутацій було виявлено тестами.
Проте деякі мутації “вижили”, що означає, що не всі граничні/негативні сценарії покриті.

Що варто покращити:

- додати більше негативних тестів (некоректні значення, порожні id, edge cases)
- окремо покрити unit-тестами валідацію для List або Anime
- зменшити кількість timeout/errors у mutation testing через оптимізацію тестів/конфігурації Stryker
